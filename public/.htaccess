<IfModule mod_rewrite.c>
      <IfModule mod_negotiation.c>
          Options -MultiViews -Indexes
      </IfModule>

      RewriteEngine On

      # Handle Authorization Header
      RewriteCond %{HTTP:Authorization} .
      RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

      # Redirect Trailing Slashes If Not A Folder...
      RewriteCond %{REQUEST_FILENAME} !-d
      RewriteCond %{REQUEST_URI} (.+)/$
      RewriteRule ^ %1 [L,R=301]

      # Send Requests To Front Controller...
      RewriteCond %{REQUEST_FILENAME} !-d
      RewriteCond %{REQUEST_FILENAME} !-f
      RewriteRule ^ index.php [L]
  </IfModule>

  # Security Headers
  <IfModule mod_headers.c>
      Header always set X-Frame-Options "DENY"
      Header always set X-Content-Type-Options "nosniff"
      Header always set X-XSS-Protection "1; mode=block"
      Header always set Referrer-Policy "strict-origin-when-cross-origin"
      Header unset Server
      Header unset X-Powered-By
      Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' 
https://www.youtube.com
  https://player.vimeo.com https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
font-src 'self'
  https://fonts.gstatic.com; img-src 'self' data: https:; media-src 'self' https:; frame-src 'self' 
https://www.youtube.com https://player.vimeo.com
  https://maps.google.com; connect-src 'self';"
  </IfModule>

  <FilesMatch "\.(env|log|md|txt|gitignore|gitattributes)$">
      Order Allow,Deny
      Deny from all
  </FilesMatch>

  RewriteRule ^(storage|bootstrap|app|config|database|resources|routes|tests|vendor)(/.*)?$ - [F,L]

  <Files ".env">
      Order Allow,Deny
      Deny from all
  </Files>
